init <- function(x, k, bs = 1, veo = FALSE) {

  D <- dim(x)[2]
  if ( bs == 1 ) {
    if ( veo ) {
      H <- matrix(nrow = k, ncol = D)
      cs <- as.numeric( sparcl::KMeansSparseCluster(x, k, wbounds = 2)[[1]]$Cs )
      for ( i in 1:k )  H[i, ] <- Rfast::colmeans(x[cs == i, , drop = FALSE])
    } else  H <- kmeans(x, k)$centers

  } else  H <- ClusterR::MiniBatchKmeans(x, clusters = k, batch_size = bs)$centroids

  H
}

